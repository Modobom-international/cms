!function(){"use strict";let e=!1;const t=function(){let e=localStorage.getItem("userUUID");e||(e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),localStorage.setItem("userUUID",e));return e}(),n=window.innerWidth<=768,o=[];let i,r=0,c=y(),a=0,s=y();const d={vi:{title:"Thông Báo Quyền Riêng Tư",message:"Chúng tôi sử dụng dữ liệu của bạn để cải thiện trải nghiệm và tối ưu quảng cáo. Bạn có đồng ý không?",decline:"Từ Chối",accept:"Đồng Ý"},en:{title:"Privacy Notice",message:"We use your data to improve your experience and optimize ads. Do you agree?",decline:"Decline",accept:"Accept"},ro:{title:"Notificare de Confidențialitate",message:"Folosim datele tale pentru a îmbunătăți experiența și a optimiza reclamele. Ești de acord?",decline:"Refuz",accept:"Accept"},th:{title:"ประกาศความเป็นส่วนตัว",message:"เราใช้ข้อมูลของคุณเพื่อปรับปรุงประสบการณ์และเพิ่มประสิทธิภาพโฆษณา คุณตกลงหรือไม่?",decline:"ปฏิเสธ",accept:"ยอมรับ"}};function l(){const t=function(){const e=(navigator.language||navigator.userLanguage||"en").split("-")[0];return d[e]?e:"en"}(),n=d[t],o=document.createElement("div");o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.backgroundColor="rgba(0, 0, 0, 0.5)",o.style.display="flex",o.style.justifyContent="center",o.style.alignItems="center",o.style.zIndex="1000",o.innerHTML=`\n            <div style="background: white; padding: 20px; border-radius: 8px; max-width: 400px; text-align: center;">\n                <h2>${n.title}</h2>\n                <p>${n.message}</p>\n                <button id="consentDecline" style="margin: 10px; padding: 10px 20px; background: #ccc; border: none; cursor: pointer;">${n.decline}</button>\n                <button id="consentAccept" style="margin: 10px; padding: 10px 20px; background: #007bff; color: white; border: none; cursor: pointer;">${n.accept}</button>\n            </div>\n        `,document.body.appendChild(o),document.getElementById("consentAccept").addEventListener("click",(()=>{e=!0,localStorage.setItem("userConsent","true"),document.body.removeChild(o),f()})),document.getElementById("consentDecline").addEventListener("click",(()=>{e=!1,localStorage.setItem("userConsent","false"),document.body.removeChild(o)}))}function u(){return e&&!function(){const e=navigator.userAgent.toLowerCase(),t=navigator.webdriver||!window.outerWidth||performance.timing.domInteractive<100;return[/bot/i,/spider/i,/crawler/i,/slurp/i,/googlebot/i,/bingbot/i,/yandexbot/i,/duckduckbot/i,/baiduspider/i,/facebot/i,/ia_archiver/i,/headless/i].some((t=>t.test(e)))||t}()}function m(){return{userAgent:navigator.userAgent,browser:function(){const e=navigator.userAgent;let t="Unknown",n="";return/chrome|crios/i.test(e)?(t="Chrome",n=e.match(/(?:chrome|crios)\/(\d+\.\d+)/i)?.[1]||""):/firefox|fxios/i.test(e)?(t="Firefox",n=e.match(/(?:firefox|fxios)\/(\d+\.\d+)/i)?.[1]||""):/safari/i.test(e)&&!/chrome/i.test(e)?(t="Safari",n=e.match(/version\/(\d+\.\d+)/i)?.[1]||""):/edg/i.test(e)&&(t="Edge",n=e.match(/edg\/(\d+\.\d+)/i)?.[1]||""),{name:t,version:n}}(),windowSize:{width:window.innerWidth,height:window.innerHeight},referrer:document.referrer||"Direct",trafficSource:function(e){if(!e||""===e)return"Direct";const t=new URL(e).hostname.toLowerCase();return t.includes("google.")?"Google Search":t.includes("facebook.com")?"Facebook":t.includes("twitter.com")||t.includes("x.com")?"Twitter":"Other"}(document.referrer),pageLoadTime:performance.timing.domContentLoadedEventEnd-performance.timing.navigationStart}}function g(e){return{tagName:e.tagName,id:e.id||"",classes:e.className?Array.from(e.classList):[],textContent:e.textContent?e.textContent.trim().substring(0,100):"",position:{x:e.getBoundingClientRect().left+window.scrollX,y:e.getBoundingClientRect().top+window.scrollY,width:e.offsetWidth,height:e.offsetHeight},isButton:"BUTTON"===e.tagName||"button"===e.type||e.classList.contains("btn"),isInput:["INPUT","TEXTAREA","SELECT"].includes(e.tagName)}}function h(){x({uuid:t,timestamp:b(),domain:window.location.hostname,path:window.location.pathname+window.location.search,userInfo:m()},"/api/heartbeat")}function w(e,t,n){u()&&o.push({time:n,event:e,data:{...t,screenWidth:window.innerWidth,screenHeight:window.innerHeight,scrollHeight:document.body.scrollHeight||document.documentElement.scrollHeight}})}function p(){const e=y();a+=e-s,s=e}function f(){window.addEventListener("focus",(()=>{s=Date.now();w("window_focus",{},b())})),window.addEventListener("blur",(()=>{p();w("window_blur",{},b())})),document.addEventListener("click",(e=>{const t=e.target,o=document.body.scrollHeight||document.documentElement.scrollHeight;let i={x:e.pageX,y:e.pageY,elementDetails:g(t),href:t.href||"",isInternalLink:t.href&&t.href.includes(window.location.origin),isLassoButton:t.classList.contains("lasso-button"),device:n?"mobile":"desktop",height:o};const r=b();v("click",i),w("click",i,r)})),document.addEventListener("mousemove",k((e=>{const t=e.target,o=e.pageX,i=e.pageY,c=n?"mobile":"desktop",a=document.body.scrollHeight||document.documentElement.scrollHeight;r++;const s={x:o,y:i,mouseMovements:r,elementDetails:g(t),device:c,height:a},d=b();v("mousemove",s),w("mousemove",s,d)}),100)),document.addEventListener("scroll",k((()=>{const e={scrollTop:window.scrollY,scrollLeft:window.scrollX,device:n?"mobile":"desktop"},t=b();v("scroll",e),w("scroll",e,t)}),100)),document.addEventListener("keydown",(e=>{0;const t=e.target,o={elementDetails:g(t),value:t.value||"",key:e.key,device:n?"mobile":"desktop"},i=b();v("keydown",o),w("keydown",o,i)})),window.addEventListener("beforeunload",(()=>{p(),u()&&o.length>0&&(clearInterval(i),x({uuid:t,domain:window.location.hostname,path:window.location.pathname+window.location.search,startTime:c,endTime:y(),totalTime:a,timeline:o,userInfo:m()},"/api/create-video-timeline"))})),h(),i=setInterval((()=>{u()?h():clearInterval(i)}),5e3)}function x(e,t){if(u()){let n=function(){const e=window.location.hostname;return"localhost"===e||"127.0.0.1"===e?"http://127.0.0.1:8000":"https://api.modobomco.com"}()+t;fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).catch((e=>console.error("Error sending data to server:",e)))}}function v(e,n){const o=window.location.pathname+window.location.search,i={eventName:e,eventData:n,timestamp:b(),user:m(),domain:window.location.hostname,uuid:t,path:o};u()&&x(i,"/api/tracking-event")}function b(){const e=new Date,t=e.getTime()+6e4*e.getTimezoneOffset();return new Date(t+252e5).toISOString()}function y(){const e=new Date,t=e.getTime()+6e4*e.getTimezoneOffset();return new Date(t+252e5).getTime()}function k(e,t){let n;return function(...o){n||(e.apply(this,o),n=!0,setTimeout((()=>n=!1),t))}}window.addEventListener("load",(function(){const t=localStorage.getItem("userConsent");"true"===t?(e=!0,f()):"false"===t?e=!1:l()}))}();