!function(){"use strict";const e=function(){let e=localStorage.getItem("userUUID");e||(e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),localStorage.setItem("userUUID",e));return e}(),t=window.innerWidth<=768,n=[];let o,i=!1,a=!0,s=!0,l=0,r=E(),c=0,d=E();const u={vi:{title:"Thông Báo Quyền Riêng Tư",message:"Trang web này sử dụng công nghệ như cookies để hỗ trợ các chức năng cần thiết, phân tích, và cá nhân hóa. Bạn có thể thay đổi cài đặt bất kỳ lúc nào hoặc chấp nhận cài đặt mặc định.",closeMessage:"Bạn có thể đóng thanh này để tiếp tục với các cookies cần thiết.",privacyNotice:"Thông Báo Quyền Riêng Tư",analytics:"Phân Tích",personalization:"Cá Nhân Hóa",save:"Lưu",acceptAll:"Chấp Nhận Tất Cả",rejectAll:"Từ Chối Tất Cả"},en:{title:"Privacy Notice",message:"This website utilizes technologies such as cookies to enable essential site functionality, analytics, and personalization. You may change your settings at any time or accept the default settings.",closeMessage:"You may close this banner to continue with only essential cookies.",privacyNotice:"Privacy Notice",analytics:"Analytics",personalization:"Personalization",save:"Save",acceptAll:"Accept All",rejectAll:"Reject All"},ro:{title:"Notificare de Confidențialitate",message:"Acest site web utilizează tehnologii precum cookie-urile pentru a activa funcționalitățile esențiale, analize și personalizare. Puteți schimba setările în orice moment sau accepta setările implicite.",closeMessage:"Puteți închide această bară pentru a continua doar cu cookie-urile esențiale.",privacyNotice:"Notificare de Confidențialitate",analytics:"Analize",personalization:"Personalizare",save:"Salvează",acceptAll:"Acceptă Toate",rejectAll:"Respinge Toate"},th:{title:"ประกาศความเป็นส่วนตัว",message:"เว็บไซต์นี้ใช้เทคโนโลยีเช่นคุกกี้เพื่อเปิดใช้งานฟังก์ชันที่จำเป็น การวิเคราะห์ และการปรับแต่งส่วนบุคคล คุณสามารถเปลี่ยนการตั้งค่าได้ทุกเมื่อหรือยอมรับการตั้งค่าเริ่มต้น",closeMessage:"คุณสามารถปิดแบนเนอร์นี้เพื่อดำเนินการต่อด้วยคุกกี้ที่จำเป็นเท่านั้น",privacyNotice:"ประกาศความเป็นส่วนตัว",analytics:"การวิเคราะห์",personalization:"การปรับแต่งส่วนบุคคล",save:"บันทึก",acceptAll:"ยอมรับทั้งหมด",rejectAll:"ปฏิเสธทั้งหมด"}};function g(){const e=function(){const e=(navigator.language||navigator.userLanguage||"en").split("-")[0];return u[e]?e:"en"}(),t=u[e],n=document.createElement("div");n.style.position="fixed",n.style.top="10px",n.style.right="10px",n.style.backgroundColor="#f5f5f5",n.style.padding="20px",n.style.borderRadius="8px",n.style.boxShadow="0 2px 10px rgba(0, 0, 0, 0.1)",n.style.maxWidth="400px",n.style.zIndex="1000",n.style.fontFamily="Arial, sans-serif",n.innerHTML=`\n            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">\n                <h2 style="font-size: 18px; margin: 0;">${t.title}</h2>\n                <button id="closePopup" style="background: none; border: none; font-size: 18px; cursor: pointer;">✕</button>\n            </div>\n            <p style="font-size: 14px; margin-bottom: 10px;">${t.message}</p>\n            <p style="font-size: 14px; margin-bottom: 20px;">${t.closeMessage} <a href="#" style="color: #007bff; text-decoration: none;">${t.privacyNotice}</a></p>\n            <div style="margin-bottom: 20px;">\n                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">\n                    <span style="font-size: 14px;">${t.analytics}</span>\n                    <label style="display: inline-flex; align-items: center; cursor: pointer;">\n                        <input type="checkbox" id="analyticsToggle" style="display: none;" ${a?"checked":""}>\n                        <div style="width: 40px; height: 20px; background-color: ${a?"#007bff":"#ccc"}; border-radius: 20px; position: relative; transition: background-color 0.3s;">\n                            <div style="width: 16px; height: 16px; background-color: white; border-radius: 50%; position: absolute; top: 2px; left: ${a?"22px":"2px"}; transition: left 0.3s;"></div>\n                        </div>\n                    </label>\n                </div>\n                <div style="display: flex; justify-content: space-between; align-items: center;">\n                    <span style="font-size: 14px;">${t.personalization}</span>\n                    <label style="display: inline-flex; align-items: center; cursor: pointer;">\n                        <input type="checkbox" id="personalizationToggle" style="display: none;" ${s?"checked":""}>\n                        <div style="width: 40px; height: 20px; background-color: ${s?"#007bff":"#ccc"}; border-radius: 20px; position: relative; transition: background-color 0.3s;">\n                            <div style="width: 16px; height: 16px; background-color: white; border-radius: 50%; position: absolute; top: 2px; left: ${s?"22px":"2px"}; transition: left 0.3s;"></div>\n                        </div>\n                    </label>\n                </div>\n            </div>\n            <div style="display: flex; flex-direction: column; gap: 10px;">\n                <button id="saveSettings" style="padding: 10px; background-color: #f0f0f0; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">${t.save}</button>\n                <button id="acceptAll" style="padding: 10px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">${t.acceptAll}</button>\n                <button id="rejectAll" style="padding: 10px; background-color: #f0f0f0; border: none; border-radius: 4px; cursor: pointer; font-size: 14px;">${t.rejectAll}</button>\n            </div>\n        `,document.body.appendChild(n);const o=document.getElementById("analyticsToggle"),l=o.nextElementSibling;o.addEventListener("change",(()=>{a=o.checked,l.style.backgroundColor=a?"#007bff":"#ccc",l.firstElementChild.style.left=a?"22px":"2px"}));const r=document.getElementById("personalizationToggle"),c=r.nextElementSibling;r.addEventListener("change",(()=>{s=r.checked,c.style.backgroundColor=s?"#007bff":"#ccc",c.firstElementChild.style.left=s?"22px":"2px"})),document.getElementById("saveSettings").addEventListener("click",(()=>{i=!0,localStorage.setItem("userConsent","true"),localStorage.setItem("analyticsEnabled",a.toString()),localStorage.setItem("personalizationEnabled",s.toString()),document.body.removeChild(n),x()})),document.getElementById("acceptAll").addEventListener("click",(()=>{i=!0,a=!0,s=!0,localStorage.setItem("userConsent","true"),localStorage.setItem("analyticsEnabled","true"),localStorage.setItem("personalizationEnabled","true"),document.body.removeChild(n),x()})),document.getElementById("rejectAll").addEventListener("click",(()=>{i=!1,a=!1,s=!1,localStorage.setItem("userConsent","false"),localStorage.setItem("analyticsEnabled","false"),localStorage.setItem("personalizationEnabled","false"),document.body.removeChild(n)})),document.getElementById("closePopup").addEventListener("click",(()=>{i=!1,a=!1,s=!1,localStorage.setItem("userConsent","false"),localStorage.setItem("analyticsEnabled","false"),localStorage.setItem("personalizationEnabled","false"),document.body.removeChild(n)}))}function p(){return i&&!function(){const e=navigator.userAgent.toLowerCase(),t=navigator.webdriver||!window.outerWidth||performance.timing.domInteractive<100;return[/bot/i,/spider/i,/crawler/i,/slurp/i,/googlebot/i,/bingbot/i,/yandexbot/i,/duckduckbot/i,/baiduspider/i,/facebot/i,/ia_archiver/i,/headless/i].some((t=>t.test(e)))||t}()}function m(){const e={userAgent:navigator.userAgent,browser:function(){const e=navigator.userAgent;let t="Unknown",n="";return/chrome|crios/i.test(e)?(t="Chrome",n=e.match(/(?:chrome|crios)\/(\d+\.\d+)/i)?.[1]||""):/firefox|fxios/i.test(e)?(t="Firefox",n=e.match(/(?:firefox|fxios)\/(\d+\.\d+)/i)?.[1]||""):/safari/i.test(e)&&!/chrome/i.test(e)?(t="Safari",n=e.match(/version\/(\d+\.\d+)/i)?.[1]||""):/edg/i.test(e)&&(t="Edge",n=e.match(/edg\/(\d+\.\d+)/i)?.[1]||""),{name:t,version:n}}(),windowSize:{width:window.innerWidth,height:window.innerHeight},referrer:document.referrer||"Direct",trafficSource:function(e){if(!e||""===e)return"Direct";const t=new URL(e).hostname.toLowerCase();return t.includes("google.")?"Google Search":t.includes("facebook.com")?"Facebook":t.includes("twitter.com")||t.includes("x.com")?"Twitter":"Other"}(document.referrer),pageLoadTime:performance.timing.domContentLoadedEventEnd-performance.timing.navigationStart};return a&&(e.analytics={pageLoadTime:e.pageLoadTime,windowSize:e.windowSize}),s&&(e.personalization={trafficSource:e.trafficSource,referrer:e.referrer}),e}function h(e){return{tagName:e.tagName,id:e.id||"",classes:e.className?Array.from(e.classList):[],textContent:e.textContent?e.textContent.trim().substring(0,100):"",position:{x:e.getBoundingClientRect().left+window.scrollX,y:e.getBoundingClientRect().top+window.scrollY,width:e.offsetWidth,height:e.offsetHeight},isButton:"BUTTON"===e.tagName||"button"===e.type||e.classList.contains("btn"),isInput:["INPUT","TEXTAREA","SELECT"].includes(e.tagName)}}function f(){w({uuid:e,timestamp:k(),domain:window.location.hostname,path:window.location.pathname+window.location.search,userInfo:m()},"/api/heartbeat")}function y(e,t,o){if(p()&&(a||s)){const i={...t};a||(delete i.screenWidth,delete i.screenHeight,delete i.scrollHeight,delete i.scrollTop,delete i.scrollLeft),s||(delete t.isInternalLink,delete t.isLassoButton),n.push({time:o,event:e,data:i})}}function b(){const e=E();c+=e-d,d=e}function x(){window.addEventListener("focus",(()=>{d=Date.now();y("window_focus",{},k())})),window.addEventListener("blur",(()=>{b();y("window_blur",{},k())})),document.addEventListener("click",(e=>{const n=e.target,o=document.body.scrollHeight||document.documentElement.scrollHeight;let i={x:e.pageX,y:e.pageY,elementDetails:h(n),href:n.href||"",isInternalLink:n.href&&n.href.includes(window.location.origin),isLassoButton:n.classList.contains("lasso-button"),device:t?"mobile":"desktop",height:o,screenWidth:window.innerWidth,screenHeight:window.innerHeight,scrollHeight:o};const a=k();v("click",i),y("click",i,a)})),document.addEventListener("mousemove",S((e=>{const n=e.target,o=e.pageX,i=e.pageY,a=t?"mobile":"desktop",s=document.body.scrollHeight||document.documentElement.scrollHeight;l++;const r={x:o,y:i,mouseMovements:l,elementDetails:h(n),device:a,height:s,screenWidth:window.innerWidth,screenHeight:window.innerHeight,scrollHeight:s},c=k();v("mousemove",r),y("mousemove",r,c)}),100)),document.addEventListener("scroll",S((()=>{const e={scrollTop:window.scrollY,scrollLeft:window.scrollX,device:t?"mobile":"desktop",screenWidth:window.innerWidth,screenHeight:window.innerHeight,scrollHeight:document.body.scrollHeight||document.documentElement.scrollHeight},n=k();v("scroll",e),y("scroll",e,n)}),100)),document.addEventListener("keydown",(e=>{0;const n=e.target,o={elementDetails:h(n),value:n.value||"",key:e.key,device:t?"mobile":"desktop"},i=k();v("keydown",o),y("keydown",o,i)})),window.addEventListener("beforeunload",(()=>{b(),p()&&n.length>0&&(clearInterval(o),w({uuid:e,domain:window.location.hostname,path:window.location.pathname+window.location.search,startTime:r,endTime:E(),totalTime:c,timeline:n,userInfo:m()},"/api/create-video-timeline"))})),f(),o=setInterval((()=>{p()?f():clearInterval(o)}),5e3)}function w(e,t){if(p()){let n=function(){const e=window.location.hostname;return"localhost"===e||"127.0.0.1"===e?"http://127.0.0.1:8000":"https://api.modobomco.com"}()+t;fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).catch((e=>console.error("Error sending data to server:",e)))}}function v(t,n){const o=window.location.pathname+window.location.search,i={eventName:t,eventData:n,timestamp:k(),user:m(),domain:window.location.hostname,uuid:e,path:o};p()&&w(i,"/api/tracking-event")}function k(){const e=new Date,t=e.getTime()+6e4*e.getTimezoneOffset();return new Date(t+252e5).toISOString()}function E(){const e=new Date,t=e.getTime()+6e4*e.getTimezoneOffset();return new Date(t+252e5).getTime()}function S(e,t){let n;return function(...o){n||(e.apply(this,o),n=!0,setTimeout((()=>n=!1),t))}}window.addEventListener("load",(function(){const e=localStorage.getItem("userConsent"),t=localStorage.getItem("analyticsEnabled"),n=localStorage.getItem("personalizationEnabled");"true"===e?(i=!0,a="true"===t,s="true"===n,x()):"false"===e?(i=!1,a=!1,s=!1):g()}))}();